<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>

<h1>Chat Room</h1>
<div class="text-dark" id="messages"></div>
<input type="text" id="user" placeholder="Your Name">
<input type="text" id="message" placeholder="Your Message">
<button id="sendButton">Send</button>

<script>
    // إنشاء اتصال مع SignalR
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/chatHub")
        .build();

    // استقبال الرسائل من الخادم
    connection.on("ReceiveMessage", (user, message) => {
        const msgDiv = document.getElementById("messages");
        const newMessage = document.createElement("div");
        newMessage.textContent = `${user}: ${message}`;
        msgDiv.appendChild(newMessage);
    });

    // بدء الاتصال
    connection.start().catch(err => console.error(err.toString()));

    // إرسال الرسالة عند الضغط على الزر
    document.getElementById("sendButton").addEventListener("click", () => {
        const user = document.getElementById("user").value;
        const message = document.getElementById("message").value;

        connection.invoke("SendMessage", user, message)
            .catch(err => console.error(err.toString()));
    });
</script>